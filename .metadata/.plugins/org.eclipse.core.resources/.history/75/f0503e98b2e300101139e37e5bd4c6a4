server:
  port: 8080 # 웹 서버 포트 (기본값: 8080)

spring:
  application:
    name: nexus-sample-app # 애플리케이션 이름 (MSA 환경에서 식별자로 사용)
  
  # =================================================================
  # [1] Datasource 설정 (Database 연결)
  # =================================================================
  datasource:
    # H2는 개발/테스트용 메모리 DB입니다. 
    # 운영 환경에서는 MSSQL 드라이버로 교체해야 합니다.
    driver-class-name: org.h2.Driver
    # MODE=MSSQLServer: H2를 MSSQL 문법과 호환되게 동작시킵니다.
    url: jdbc:h2:mem:nexus;DB_CLOSE_DELAY=-1;MODE=MSSQLServer
    username: sa
    password:

  # =================================================================
  # [2] H2 Console 설정 (웹 관리 도구)
  # =================================================================
  h2:
    console:
      enabled: true      # H2 콘솔 사용 여부 (운영 시 false 권장)
      path: /h2-console  # 접속 경로 (http://localhost:8080/h2-console)

  # =================================================================
  # [3] JPA/Hibernate 설정
  # =================================================================
  jpa:
    hibernate:
      # [중요] ddl-auto 설정 가이드
      # - create/update: Hibernate가 자동으로 테이블 생성/변경 (위험)
      # - validate: DB 스키마와 Entity 클래스가 일치하는지만 확인 (안전)
      # * NEXUS는 Flyway로 스키마를 관리하므로 'validate'를 사용합니다.
      ddl-auto: validate 

# =================================================================
# [4] NEXUS Framework 전용 설정 (Root Level)
# =================================================================
nexus:
  # 4-1. DB 마이그레이션 (Flyway)
  migration:
    enabled: true # true: 서버 시작 시 SQL 스크립트로 DB 형상 관리 수행

  # 4-2. 보안 설정 (Security)
  security:
    enabled: true         # 보안 모듈 전체 활성화 여부
    use-form-login: false # true: 폼 로그인 사용(관리자용) / false: API 모드(JWT only)
    
    # [추가 허용 URL]
    # 프레임워크 기본 허용 URL(H2, Swagger 등) 외에 추가로 열어줄 경로
    public-urls:
      - "/api/public/**"  # 예시: 로그인 없이 접근 가능한 공통 API
      - "/health-check"   # 예시: 로드밸런서 헬스 체크
      
    # [제외 URL]
    # 기본 허용 URL 중 보안상 막고 싶은 경로 (운영 배포 시 주석 해제 권장)
    # exclude-urls:
    #   - "/h2-console/**"  # 운영 환경에서는 DB 콘솔 접근 차단
    #   - "/swagger-ui/**"  # 운영 환경에서는 API 문서 접근 차단

# =================================================================
# [5] MyBatis 설정 (SQL Mapper)
# =================================================================
mybatis:
  mapper-locations: classpath:mapper/**/*.xml  # SQL XML 파일 위치
  type-aliases-package: com.nexus.sample       # DTO/Entity가 위치한 패키지 (별칭 자동 생성)
  configuration:
    map-underscore-to-camel-case: true         # DB(user_id) -> Java(userId) 자동 변환
    jdbc-type-for-null: NULL                   # 파라미터가 null일 때 처리 방식

# =================================================================
# [6] 로깅 설정 (Logging)
# =================================================================
logging:
  level:
    root: INFO                  # 전체 기본 로그 레벨
    com.nexus: DEBUG            # NEXUS 프레임워크 내부 동작 로그 (개발 시 DEBUG 권장)
    com.nexus.sample: DEBUG     # 현재 애플리케이션 로직 로그
  pattern:
    # 로그 출력 포맷 (날짜, 레벨, PID, 스레드, 로거명, 메시지)
    console: "%d{yyyy-MM-dd'T'HH:mm:ss.SSSXXX} %-5level %pid [%thread] %logger{36} : %msg%n"